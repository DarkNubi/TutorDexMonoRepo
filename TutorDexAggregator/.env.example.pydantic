# =============================================================================
# TutorDexAggregator Environment Configuration (Pydantic-Settings)
# =============================================================================
# Generated from `shared/config.py` (authoritative).
# Copy to `.env` and fill in values as needed. Do not commit real `.env` files.
# =============================================================================

# ----------------------------------------------------------------------------
# PIPELINE
# ----------------------------------------------------------------------------
EXTRACTION_PIPELINE_VERSION=2026-01-02_det_time_v1
SCHEMA_VERSION=2026-01-01
EXTRACTION_QUEUE_ENABLED=true
EXTRACTION_MAX_ATTEMPTS=3
EXTRACTION_WORKER_BATCH_SIZE=10
EXTRACTION_WORKER_IDLE_S=2.0
EXTRACTION_WORKER_MAX_JOBS=0
EXTRACTION_WORKER_ONESHOT=false
EXTRACTION_BACKOFF_BASE_S=1.5
EXTRACTION_BACKOFF_MAX_S=60.0
EXTRACTION_STALE_PROCESSING_SECONDS=900

# ----------------------------------------------------------------------------
# SUPABASE
# ----------------------------------------------------------------------------
SUPABASE_URL_DOCKER=
SUPABASE_URL_HOST=
SUPABASE_URL=
SUPABASE_SERVICE_ROLE_KEY=
SUPABASE_KEY=
SUPABASE_ENABLED=false
SUPABASE_RAW_ENABLED=false
SUPABASE_ASSIGNMENTS_TABLE=assignments
SUPABASE_RAW_MESSAGES_TABLE=telegram_messages_raw
SUPABASE_RAW_CHANNELS_TABLE=telegram_channels
SUPABASE_RAW_PROGRESS_TABLE=ingestion_run_progress
SUPABASE_RAW_RUNS_TABLE=ingestion_runs
SUPABASE_BUMP_MIN_SECONDS=21600

# ----------------------------------------------------------------------------
# TELEGRAM
# ----------------------------------------------------------------------------
TELEGRAM_API_ID=
TELEGRAM_API_HASH=
SESSION_STRING=
TG_SESSION=tutordex.session
TG_SESSION_RECOVERY=tutordex_recovery.session
GROUP_BOT_TOKEN=
DM_BOT_TOKEN=
ALERT_BOT_TOKEN=
TELEGRAM_MAX_RETRIES=5
TELEGRAM_INITIAL_RETRY_DELAY=1.0
TELEGRAM_MAX_RETRY_DELAY=300.0
TELEGRAM_BACKOFF_MULTIPLIER=2.0

# ----------------------------------------------------------------------------
# LLM
# ----------------------------------------------------------------------------
LLM_API_URL=http://localhost:1234
LLM_MODEL_NAME=lfm2-8b-a1b
LLM_TIMEOUT_SECONDS=200
LLM_SYSTEM_PROMPT_FILE=
LLM_SYSTEM_PROMPT_TEXT=
LLM_INCLUDE_EXAMPLES=false
LLM_EXAMPLES_DIR=
LLM_EXAMPLES_VARIANT=
LLM_MOCK_OUTPUT_FILE=
LLM_ASSIGNMENT_CODE_EXTRACTOR_MOCK_FILE=
LLM_CIRCUIT_BREAKER_THRESHOLD=5
LLM_CIRCUIT_BREAKER_TIMEOUT_SECONDS=60

# ----------------------------------------------------------------------------
# BROADCAST
# ----------------------------------------------------------------------------
ENABLE_BROADCAST=false
BROADCAST_FALLBACK_FILE=
BROADCAST_MAX_ATTEMPTS=3
BROADCAST_RETRY_BASE_SECONDS=1.0
BROADCAST_RETRY_MAX_SLEEP_SECONDS=30.0
BROADCAST_MAX_MESSAGE_LEN=3800
BROADCAST_MAX_REMARKS_LEN=800
BROADCAST_DUPLICATE_MODE=skip
ENABLE_BROADCAST_TRACKING=false
BROADCAST_SYNC_ON_STARTUP=false

# ----------------------------------------------------------------------------
# DMS
# ----------------------------------------------------------------------------
ENABLE_DMS=false
DM_BOT_API_URL=
DM_ENABLED=false
DM_MAX_RECIPIENTS=50
DM_FALLBACK_FILE=
DM_FILTER_DUPLICATES=true
DM_USE_ADAPTIVE_THRESHOLD=false
DM_RATING_LOOKBACK_DAYS=7
DM_RATING_AVG_RATE_LOOKBACK_DAYS=30

# ----------------------------------------------------------------------------
# LOGGING
# ----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_DIR=
LOG_FILE=
LOG_JSON=false
LOG_TO_CONSOLE=true
LOG_TO_FILE=true
LOG_MAX_BYTES=5000000
LOG_BACKUP_COUNT=5

# ----------------------------------------------------------------------------
# OTEL
# ----------------------------------------------------------------------------
OTEL_ENABLED=false
OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
OTEL_SERVICE_NAME=

# ----------------------------------------------------------------------------
# SENTRY
# ----------------------------------------------------------------------------
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=
SENTRY_SERVICE_NAME=
SENTRY_TRACES_SAMPLE_RATE=
SENTRY_PROFILES_SAMPLE_RATE=

# ----------------------------------------------------------------------------
# RECOVERY
# ----------------------------------------------------------------------------
RECOVERY_CATCHUP_ENABLED=true
RECOVERY_CATCHUP_STATE_FILE=state/recovery_catchup_state.json
RECOVERY_CATCHUP_CHECK_INTERVAL_SECONDS=30
RECOVERY_CATCHUP_CHUNK_HOURS=6
RECOVERY_CATCHUP_OVERLAP_MINUTES=10
RECOVERY_CATCHUP_TARGET_LAG_MINUTES=2
RECOVERY_CATCHUP_QUEUE_LOW_WATERMARK=0
RECOVERY_BACKFILL_MAX_ATTEMPTS=5
RECOVERY_BACKFILL_BASE_BACKOFF_SECONDS=2.0

# ----------------------------------------------------------------------------
# GEOCODING
# ----------------------------------------------------------------------------
DISABLE_NOMINATIM=false
NOMINATIM_USER_AGENT=
NOMINATIM_RETRIES=3
NOMINATIM_BACKOFF_SECONDS=1.0

# ----------------------------------------------------------------------------
# ASSETS
# ----------------------------------------------------------------------------
SUBJECT_TAXONOMY_ENABLED=false
SUBJECT_TAXONOMY_PATH=
SUBJECT_TAXONOMY_DEBUG=false
REGION_GEOJSON_PATH=
MRT_DATA_JSON_PATH=

# ----------------------------------------------------------------------------
# TUTORCITY
# ----------------------------------------------------------------------------
TUTORCITY_API_URL=
TUTORCITY_USER_AGENT=
TUTORCITY_LIMIT=50
TUTORCITY_TIMEOUT_SECONDS=30

# ----------------------------------------------------------------------------
# TOOLS
# ----------------------------------------------------------------------------
AB_PIPELINE_A=
AB_PIPELINE_B=
AB_SINCE_ISO=
AB_UNTIL_ISO=
AB_OUT_DIR=
AB_EXTRA_METRICS=
EDIT_MONITOR_DB_PATH=
EDIT_MONITOR_EVENTS_JSONL=
EDIT_MONITOR_HISTORIC_FETCH=50
EDIT_MONITOR_INCLUDE_TEXT=true
EDIT_MONITOR_MAX_TEXT_CHARS=20000
EDIT_MONITOR_SUMMARY_INTERVAL_SECONDS=600

# ----------------------------------------------------------------------------
# MISC
# ----------------------------------------------------------------------------
COMPILATION_DISTINCT_CODES=2
COMPILATION_LABEL_HITS=2
COMPILATION_POSTAL_HITS=2
COMPILATION_URL_HITS=2
COMPILATION_BLOCK_COUNT=5
COMPILATION_APPLY_NOW_HITS=2
ENABLE_DETERMINISTIC_SIGNALS=true
USE_DETERMINISTIC_TIME=true
USE_NORMALIZED_TEXT_FOR_LLM=false
HARD_VALIDATE_MODE=report
ENABLE_POSTAL_CODE_ESTIMATED=true
FRESHNESS_TIER_ENABLED=false
FRESHNESS_GREEN_HOURS=24
FRESHNESS_YELLOW_HOURS=36
FRESHNESS_ORANGE_HOURS=48
FRESHNESS_RED_HOURS=72
GEO_ENRICHMENT_ENABLED=true
SESSION_STRING_RECOVERY=
CHANNEL_LIST=
TUTOR_MATCH_URL=http://127.0.0.1:8000/match/payload
BACKEND_API_KEY=
AGGREGATOR_CHANNEL_ID=
AGGREGATOR_CHANNEL_IDS=
BOT_API_URL=
SKIPPED_MESSAGES_CHAT_ID=
SKIPPED_MESSAGES_THREAD_ID=
SKIPPED_MESSAGES_THREAD_ID_EXTRACTION_ERRORS=
SKIPPED_MESSAGES_THREAD_ID_NON_ASSIGNMENT=
SKIPPED_MESSAGES_THREAD_ID_COMPILATIONS=
ALERT_CHAT_ID=
ALERT_THREAD_ID=
ALERT_PREFIX=
DUPLICATE_DETECTION_ENABLED=true
RAW_FALLBACK_FILE=
