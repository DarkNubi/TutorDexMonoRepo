services:
  collector-tail:
    build: .
    env_file:
      - .env
    command: ["python", "collector.py", "tail"]
    restart: unless-stopped
    volumes:
      - ./:/app
      - ./logs:/app/logs
    # Expose if you run a local LLM server inside this compose; otherwise it will reach host/localhost by default.
    # network_mode: host

  worker:
    build: .
    env_file:
      - .env
    command: ["python", "workers/extract_worker.py"]
    restart: unless-stopped
    depends_on:
      - collector-tail
    volumes:
      - ./:/app
      - ./logs:/app/logs
