# Redis connection
# - When running via repo-root `docker compose up`, Redis is provided automatically as `redis://redis:6379/0`.
# - When running the backend directly on your host (no Docker), use `redis://localhost:6379/0`.
REDIS_URL=redis://redis:6379/0
REDIS_PREFIX=tutordex

# Environment mode
# - dev: missing ADMIN_API_KEY is allowed (to ease local iteration)
# - prod: ADMIN_API_KEY is required at startup
# APP_ENV=dev

# Matching threshold
MATCH_MIN_SCORE=3

# Optional Supabase persistence (recommended)
# SUPABASE_ENABLED=true
# Supabase URL routing (optional):
# SUPABASE_URL_DOCKER=http://supabase-kong:8000             # Supabase self-host (Docker network; no /rest/v1 suffix)
# SUPABASE_URL_HOST=http://127.0.0.1:54321                  # Supabase self-host (host port; change to your setup)
#
# Fallback:
# SUPABASE_URL=https://<project-ref>.supabase.co            # Supabase Cloud
# SUPABASE_URL=https://supabase-api.example.com             # Supabase self-host (Kong public URL; no /rest/v1 suffix)
# SUPABASE_SERVICE_ROLE_KEY=

# Firebase Auth enforcement for website calls
# - In production (`APP_ENV=prod`), the backend requires `AUTH_REQUIRED=true` and Firebase Admin to be configured,
#   otherwise it fails fast at startup.
# FIREBASE_ADMIN_ENABLED=true
# Put the JSON at `TutorDexBackend/secrets/firebase-admin-service-account.json` and mount it via the root `docker-compose.yml`.
# FIREBASE_ADMIN_CREDENTIALS_PATH=/run/secrets/firebase-admin-service-account.json
# AUTH_REQUIRED=true
# CORS_ALLOW_ORIGINS=*

# Optional admin/bot auth (recommended)
# ADMIN_API_KEY=

# ----------------------------
# Click tracking (tracked links + broadcast edit)
# ----------------------------
# CLICK_TRACKING_SECRET=change-me
# TRACKING_EDIT_BOT_TOKEN=            # must match the bot that posted the broadcast message
# CLICK_EDIT_MIN_INTERVAL_SECONDS=20
# CLICK_TRACKING_IP_COOLDOWN_SECONDS=10   # per-IP cooldown to prevent click spam (set 0 to disable)

# ----------------------------
# Telegram webhook (for inline button callbacks)
# ----------------------------
# Required for inline buttons in broadcast messages to work.
# Setup: python TutorDexBackend/telegram_webhook_setup.py set --url https://yourdomain.com/telegram/callback
#
# WEBHOOK_SECRET_TOKEN=                # Secret token to verify webhook requests (recommended)
#
# Note: Your backend must be publicly accessible at the webhook URL for Telegram to send callbacks.
# The webhook endpoint is /telegram/callback and handles inline button interactions.

# Logging (optional)
# LOG_LEVEL=INFO
# LOG_TO_CONSOLE=true
# LOG_TO_FILE=true
# LOG_JSON=false
# LOG_DIR=TutorDexBackend\\logs
# LOG_FILE=tutordex_backend.log
# LOG_MAX_BYTES=5000000
# LOG_BACKUP_COUNT=5

# OpenTelemetry (optional; Tempo is wired via docker compose)
# OTEL_ENABLED=true
# OTEL_EXPORTER_OTLP_ENDPOINT=http://otel-collector:4318
