[importlinter]
root_packages =
    TutorDexAggregator
    TutorDexBackend
    shared

[importlinter:contract:backend-independence]
name = Backend should not import from Aggregator
type = forbidden
source_modules =
    TutorDexBackend
forbidden_modules =
    TutorDexAggregator
ignore_imports =
    shared.observability.exception_handler -> TutorDexAggregator.observability_metrics

[importlinter:contract:aggregator-independence]
name = Aggregator should not import from Backend
type = forbidden
source_modules =
    TutorDexAggregator
forbidden_modules =
    TutorDexBackend
ignore_imports =
    shared.observability.exception_handler -> TutorDexBackend.metrics

[importlinter:contract:shared-no-app-imports]
name = Shared should not import from application code
type = forbidden
source_modules =
    shared
forbidden_modules =
    TutorDexAggregator
    TutorDexBackend
ignore_imports =
    shared.observability.exception_handler -> TutorDexAggregator.observability_metrics
    shared.observability.exception_handler -> TutorDexBackend.metrics

[importlinter:contract:no-circular-backend]
name = No circular imports within Backend
type = layers
layers =
    TutorDexBackend.routes
    TutorDexBackend.services
    TutorDexBackend.utils

[importlinter:contract:no-circular-aggregator]
name = No circular imports within Aggregator
type = layers
layers =
    TutorDexAggregator.workers
    TutorDexAggregator.services
    TutorDexAggregator.extractors
    TutorDexAggregator.utils
